ip prefix-list ANY-PL seq 10 permit 0.0.0.0/0 le 32
!
route-map MLPEER-RM permit 10
   match interface Vlan4094
   set as-path prepend auto
!
route-map MLPEER-RM permit 20
   match ip address prefix-list ANY-PL
!
interface Loopback2
   description VTEP
!
router bgp 641{{ hec.hec_nr }}.10003
   bgp asn notation asdot
   maximum-paths 8 ecmp 16
   {% if hec.fabric.vtep_distribution_mode == "evpn" %}
   neighbor EVPN-PG peer-group
   neighbor EVPN-PG remote-as 641{{ hec.hec_nr }}.10000
   neighbor EVPN-PG update-source Loopback1
   neighbor EVPN-PG send-community standard extended
   neighbor EVPN-PG ebgp-multihop 2
   neighbor EVPN-PG maximum-routes 0
   neighbor EVPN-PG fall-over bfd
   !
   address-family evpn
      neighbor EVPN-PG activate
   !
   address-family ipv4
      no neighbor EVPN-PG activate
   !
   address-family ipv6
      no neighbor EVPN-PG activate
   !
   {% endif %}
   !
   neighbor SPINE-PG peer-group
   neighbor SPINE-PG soft-reconfiguration inbound all
   neighbor SPINE-PG send-community
   neighbor SPINE-PG fall-over bfd
   neighbor SPINE-PG route-map MLPEER-RM out
   neighbor SPINE-PG maximum-routes {{ hec.fabric.bgp_maximum_routes }}
   neighbor SPINE-PG remote-as 641{{ hec.hec_nr }}.10000
   !
   neighbor MLPEER-PG peer-group
   neighbor MLPEER-PG next-hop-self
   neighbor MLPEER-PG maximum-routes {{ hec.fabric.bgp_maximum_routes }}
   neighbor MLPEER-PG remote-as 641{{ hec.hec_nr }}.10003
   network 10.200.1.3/32
   !
   {% for i in range(11,14) %}
   neighbor 10.100.0.{{ i }} peer-group EVPN-PG
   {% endfor %}
   !
interface Vxlan1
   vxlan source-interface Loopback2
   {% if hec.fabric.vtep_distribution_mode == "cvx" %}
   vxlan controller-client
   {% endif %}
   {% if hec.fabric.vtep_distribution_mode == "manual" %}
   vxlan flood vtep 10.200.1.1 10.200.1.2 10.200.1.3 10.200.1.4
   {% endif %}
   {% for i in (5,6,7,10,20,30,40,50,60,70,75,85,90,95,100,110,120,130,140,900,931,940) %}
   vxlan vlan {{ i }} vni {{ i + 10000 }}
   {% endfor %}
   {% for i in range(1,499) %}
   vxlan vlan 200{{ i }} vni {{ i + 2001000 }}
   {% endfor %}
