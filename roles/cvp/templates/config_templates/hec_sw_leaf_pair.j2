mlag configuration
   domain-id $MLAG_NAME

interface Loopback2
   description VTEP
   ip address $LOOPBACK2_IP/32

router bgp $BGP_AS
   bgp asn notation asdot
   maximum-paths 8 ecmp 16
   !
   neighbor SPINE-PG peer-group
   neighbor SPINE-PG remote-as $SPINE_AS
   neighbor SPINE-PG soft-reconfiguration inbound all
   neighbor SPINE-PG send-community
   neighbor SPINE-PG route-map MLPEER-RM out
   neighbor SPINE-PG maximum-routes $EBGP_RTMAX
   neighbor SPINE-PG fall-over bfd
   !
   neighbor MLPEER-PG peer-group
   neighbor MLPEER-PG remote-as $BGP_AS
   neighbor MLPEER-PG next-hop-self
   neighbor MLPEER-PG maximum-routes $IBGP_RTMAX
   neighbor MLPEER-PG fall-over bfd
   network $LOOPBACK2_IP/32
   !
{#
  Let's create evpn peerings even though the fabric is not
  doing mac-learing via evpn yet.
  We will move each existing location from cvx or manual
  mac-learning to evpn.
#}
   neighbor EVPN-PG peer-group
   neighbor EVPN-PG remote-as $SPINE_AS
   neighbor EVPN-PG update-source Loopback1
   neighbor EVPN-PG send-community standard extended
   neighbor EVPN-PG ebgp-multihop 2
   neighbor EVPN-PG maximum-routes $EVPN_RTMAX
   neighbor EVPN-PG fall-over bfd
   !
{% for i in range(11,14) %}
   neighbor 10.100.0.{{i}} peer-group EVPN-PG
{% endfor %}
   !
   address-family evpn
      neighbor EVPN-PG activate
   !
   address-family ipv4
      no neighbor EVPN-PG activate
   !
   address-family ipv6
      no neighbor EVPN-PG activate
   !
   vlan-aware-bundle service-vlans
      rd $LOOPBACK1_IP:1
      route-target both 1:1
      redistribute learned
      vlan 5-2999
   !
